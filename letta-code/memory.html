<!DOCTYPE html>
<html lang="zh-CN" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Letta Code 记忆系统 - 了解分层记忆系统">
    <title>记忆系统 | Letta 文档</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../css/style.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        'primary-dark': '#4f46e5',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white dark:bg-slate-900 text-slate-900 dark:text-slate-100">
    <!-- 导航栏 -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-700">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <a href="../index.html" class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-sm">L</span>
                    </div>
                    <span class="font-bold text-xl">Letta 文档</span>
                </a>
                <div class="hidden md:flex items-center space-x-6">
                    <a href="index.html" class="text-indigo-500 font-medium">Letta Code</a>
                    <a href="../core-concepts/index.html" class="text-slate-600 dark:text-slate-300 hover:text-indigo-500">核心概念</a>
                    <a href="../api/python/index.html" class="text-slate-600 dark:text-slate-300 hover:text-indigo-500">API 参考</a>
                    <a href="../guides/docker.html" class="text-slate-600 dark:text-slate-300 hover:text-indigo-500">指南</a>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="theme-toggle" class="p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800">
                        <svg class="w-5 h-5 hidden dark:block" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"/></svg>
                        <svg class="w-5 h-5 block dark:hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/></svg>
                    </button>
                    <a href="https://github.com/letta-ai/letta" target="_blank" class="p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <div class="flex pt-16">
        <!-- 侧边栏 -->
        <aside class="hidden lg:block w-64 fixed left-0 top-16 h-[calc(100vh-4rem)] overflow-y-auto border-r border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50">
            <nav class="p-4 space-y-1">
                <p class="text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2">开始使用</p>
                <a href="index.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">概述</a>
                <a href="quickstart.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">快速开始</a>

                <p class="text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mt-6 mb-2">功能</p>
                <a href="memory.html" class="block px-3 py-2 rounded-lg bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 font-medium">记忆系统</a>
                <a href="models.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">模型配置</a>
                <a href="skills.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">技能系统</a>
                <a href="subagents.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">子代理</a>

                <p class="text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mt-6 mb-2">参考</p>
                <a href="cli-reference.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">CLI 参考</a>
                <a href="headless.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">无头模式</a>
                <a href="configuration.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">配置</a>
                <a href="providers.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">提供商</a>

                <p class="text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mt-6 mb-2">深入</p>
                <a href="how-it-works.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">工作原理</a>
                <a href="sdk.html" class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300">SDK</a>
            </nav>
        </aside>

        <!-- 主内容区 -->
        <main class="flex-1 lg:ml-64">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <div class="doc-content">
                    <h1>记忆系统</h1>
                    <p class="text-xl text-slate-600 dark:text-slate-400 mb-8">
                        了解 Letta Code 的分层记忆系统
                    </p>

                    <p>使用 Letta Code，您可以无限期地使用同一个代理 - 跨会话、跨天或跨月 - 让它随时间变得更好。您的代理记住过去的交互，学习您的偏好，并在工作时自我编辑自己的记忆。</p>

                    <p>Letta Code 代理旨在随时间变得更加复杂。通常，每个 git 仓库使用一个代理是良好的实践——这将有助于开发高度专门化于特定项目或任务的代理。您还可以通过使用专注于项目特定方面的代理来进一步专门化您的代理，例如设计、后端、安全、数据库等。</p>

                    <p>有关 Letta 记忆系统的更多一般信息，请参阅<strong><a href="../core-concepts/index.html">主要指南</a></strong>。</p>

                    <h2 id="starting-session">开始会话</h2>
                    <p>当您在项目目录中运行 <code>letta</code> 时，Letta Code 会与您上次使用的代理开始新对话：</p>
                    <pre><code>letta</code></pre>
                    <pre><code>● Starting new conversation with my-agent
→ /agents list all agents
→ /resume resume a previous conversation</code></pre>

                    <ul>
                        <li><strong>现有项目</strong> → 与上次使用的代理开始新对话（记忆持久存在）</li>
                        <li><strong>新项目</strong> → 自动创建新代理</li>
                    </ul>

                    <p>您的代理记忆无限期持久存在——关闭终端，几天后回来，您的代理仍然记得一切。使用 <code>letta --resume</code> 继续您确切的最后一次会话，包括消息历史。</p>

                    <h3 id="agent-options">代理选项</h3>
                    <pre><code>letta --new                    # 强制创建新代理
letta --agent &lt;agent-id&gt;       # 通过 ID 连接到特定代理</code></pre>

                    <h2 id="pinned-agents">固定代理</h2>
                    <p>固定代理以便在项目之间快速访问它们。</p>

                    <h3 id="pinning">固定代理</h3>
                    <pre><code>> /pin          # 全局固定当前代理（到处可用）
> /pin -l       # 本地固定当前代理（仅限此项目）
> /unpin        # 取消全局固定
> /unpin -l     # 取消本地固定</code></pre>

                    <p>您也可以在固定时重命名代理：</p>
                    <pre><code>> /pin MyAgent  # 重命名并固定</code></pre>

                    <h3 id="managing-pinned">管理固定代理</h3>
                    <pre><code>> /pinned       # 打开固定代理选择器
> /resume       # 浏览所有代理</code></pre>

                    <p>使用选择器：</p>
                    <ul>
                        <li><strong>Enter</strong> - 切换到代理</li>
                        <li><strong>P</strong> - 本地固定/取消固定选中的代理</li>
                        <li><strong>D</strong> - 从所有位置取消固定</li>
                    </ul>

                    <h2 id="initializing">初始化记忆</h2>
                    <p>开始新项目时，运行 <code>/init</code> 帮助您的代理了解代码库：</p>
                    <pre><code>> /init</code></pre>

                    <h3 id="what-init-does"><code>/init</code> 做什么</h3>
                    <p><code>/init</code>、<code>/remember</code> 和其他命令使用的内部提示在 <a href="https://github.com/letta-ai/letta-code" target="_blank">Letta Code 仓库</a>中可用。这些定义了您运行每个命令时代理接收的确切指令。</p>

                    <p>代理会首先询问您问题以了解您的需求：</p>
                    <ul>
                        <li><strong>研究深度</strong>：标准（快速，约 5-20 次工具调用）或深度（全面，约 100+ 次工具调用）</li>
                        <li><strong>您的身份</strong>：您是哪个 git 贡献者？这有助于将 git 历史与您的编码风格关联起来</li>
                        <li><strong>相关仓库</strong>：是否有其他仓库（后端、共享库）您经常使用？</li>
                        <li><strong>工作流偏好</strong>：代理应该多主动？自动提交还是先询问？</li>
                        <li><strong>沟通风格</strong>：简洁还是详细的回复？</li>
                    </ul>

                    <p>然后代理会研究您的项目：</p>

                    <p><strong>标准初始化</strong>专注于要点：</p>
                    <ul>
                        <li>读取 README、package.json、配置文件</li>
                        <li>查看 git 状态和最近的提交（自动提供）</li>
                        <li>探索关键目录</li>
                        <li>创建/更新记忆块，包含项目命令、架构和您的偏好</li>
                    </ul>

                    <p><strong>深度研究初始化</strong>是全面的：</p>
                    <ul>
                        <li>包含标准初始化的所有内容，加上：</li>
                        <li>分析 git 历史以了解提交模式和约定</li>
                        <li>识别主要贡献者和团队动态</li>
                        <li>深入探索多个目录的架构</li>
                        <li>识别痛点（经常出 bug 的区域）和代码演化</li>
                        <li>为约定、注意事项和架构创建专门的记忆块</li>
                    </ul>

                    <h3 id="memory-blocks-created">创建的记忆块</h3>
                    <p><code>/init</code> 通常创建或更新这些块：</p>
                    <ul>
                        <li><strong><code>human</code></strong>：您的身份、工作流偏好和沟通风格</li>
                        <li><strong><code>persona</code></strong>：您希望代理遵循的行为规则</li>
                        <li><strong><code>project</code></strong>：通常分成多个专注的块：
                            <ul>
                                <li><code>project-commands</code>：构建、测试、lint 命令</li>
                                <li><code>project-architecture</code>：目录结构和关键模块</li>
                                <li><code>project-conventions</code>：提交风格、PR 流程、代码模式</li>
                                <li><code>project-gotchas</code>：注意事项和需要警惕的事情</li>
                            </ul>
                        </li>
                    </ul>

                    <p>代理在研究时增量更新记忆，确保即使在长时间研究会话中也不会丢失任何内容。</p>

                    <p>每当您希望代理重新分析项目时，再次运行 <code>/init</code>，例如在重大更改后或添加您希望代理摄取的文档后。</p>

                    <h2 id="updating-memory">更新记忆</h2>

                    <h3 id="automatic-updates">自动更新</h3>
                    <p>随着代理的工作，它可能会用重要信息更新其记忆。例如，在发现您的项目使用 <code>pnpm</code> 而不是 <code>npm</code> 后，它可能会决定为将来的会话记住这一点。</p>

                    <h3 id="manual-updates">手动更新</h3>
                    <p>代理有时可能无法自行存储信息，或者它们可能没有注意到特定信息对将来有用。</p>

                    <p>您可以使用 <code>/remember</code> 明确告诉代理记住某些内容：</p>
                    <pre><code>> /remember Always use pnpm instead of npm in this project</code></pre>

                    <p>不带参数时，代理会反思最近的交互并适当更新记忆：</p>
                    <pre><code>> /remember</code></pre>

                    <p>调用 <code>/remember</code> 时使用的提示在<a href="https://github.com/letta-ai/letta-code" target="_blank">这里</a>可用。</p>

                    <p>如果您的代理没有一致地记住重要信息，请让代理更新其策略以便将来更加勤奋，并传达您期望它存储什么信息。例如，"主动存储关于我的偏好、决策以及我明确要求您记住的任何内容的信息。"</p>

                    <h3 id="sleeptime">睡眠时间记忆</h3>
                    <p>代理使用工具（如 <code>memory</code>）记住信息。代理必须<strong>主动</strong>选择记住信息，除非代理附加了<a href="https://docs.letta.com/guides/agents/sleeptime" target="_blank">睡眠时间代理</a>。当睡眠时间代理附加到您的编程代理时，记忆操作被卸载到异步代理，该代理设计用于在主代理工作时被动更新记忆。</p>

                    <p>创建新代理时启用睡眠时间代理：</p>
                    <pre><code>letta --new --sleeptime</code></pre>

                    <p>或在 <code>~/.letta/settings.json</code> 中将其设置为默认：</p>
                    <pre><code>{
  "enableSleeptime": true
}</code></pre>

                    <p>有关睡眠时间如何工作的更多详细信息，请参阅<a href="https://docs.letta.com/guides/agents/sleeptime" target="_blank">睡眠时间代理文档</a>。</p>

                    <p>睡眠时间可能会提高您主要编程代理的记忆质量，但也可能导致额外成本。</p>

                    <h2 id="viewing-blocks">查看记忆块</h2>
                    <p>使用 <code>/memory</code> 命令查看附加到代理的所有记忆块：</p>
                    <pre><code>> /memory</code></pre>

                    <p>记忆查看器显示：</p>
                    <ul>
                        <li><strong>列表视图</strong>：所有块及其标签、字符数、描述预览和内容预览（3 行）</li>
                        <li><strong>详情视图</strong>：在块上按 <code>Enter</code> 查看其完整内容和滚动</li>
                    </ul>

                    <p>导航：</p>
                    <ul>
                        <li><code>j</code>/<code>k</code> 或方向键在块之间导航</li>
                        <li><code>Enter</code> 查看完整块内容</li>
                        <li><code>ESC</code> 返回或关闭</li>
                    </ul>

                    <p>您也可以点击"在 ADE 中查看/编辑"链接，在 <a href="https://app.letta.com" target="_blank">Letta ADE</a> 中打开块进行直接编辑。</p>

                    <h2 id="how-memory-works">记忆如何工作</h2>
                    <p>记忆作为<strong>块</strong>存储在 Letta 服务器上。</p>

                    <p>每个块都有一个标签、描述、内容和大小限制。</p>

                    <p>代理可以读取和写入自己的块。</p>

                    <p>要了解更多关于记忆块的信息，请查看<a href="../core-concepts/index.html">主要文档页面</a>。</p>

                    <h3 id="config-files">配置文件</h3>
                    <p>本地文件跟踪固定代理和设置：</p>

                    <div class="overflow-x-auto">
                        <table>
                            <thead>
                                <tr>
                                    <th>文件</th>
                                    <th>用途</th>
                                    <th>Git</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>~/.letta/settings.json</code></td>
                                    <td>全局固定代理、API 密钥</td>
                                    <td>N/A</td>
                                </tr>
                                <tr>
                                    <td><code>.letta/settings.local.json</code></td>
                                    <td>上次使用的代理、本地固定代理</td>
                                    <td>忽略</td>
                                </tr>
                                <tr>
                                    <td><code>.letta/settings.json</code></td>
                                    <td>共享项目设置</td>
                                    <td>提交</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h2 id="best-practices">最佳实践</h2>
                    <ol>
                        <li><strong>在新项目上运行 <code>/init</code></strong> - 帮助代理了解您的代码库</li>
                        <li><strong>使用 <code>/remember</code> 保存重要上下文</strong> - 明确保存您希望持久化的信息</li>
                        <li><strong>提交 <code>.letta/settings.json</code></strong> - 与您的团队共享项目上下文</li>
                        <li><strong>保持 <code>.letta/settings.local.json</code> 在 gitignore 中</strong> - 个人设置保持个人</li>
                    </ol>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/main.js"></script>
</body>
</html>
